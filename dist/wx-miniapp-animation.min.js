/*!
 * wx-miniapp-animation.js v0.0.1
 * (c) 2019-2020 kallsave
 * Released under the MIT License.
 */
/*!
 * wx-miniapp-animation.js v0.0.1
 * (c) 2019-2020 kallsave
 * Released under the MIT License.
 */
var t,e;t=this,e=function(){"use strict";function t(e){let i,s=function(t){return Object.prototype.toString.call(t).slice(8,-1)}(e);if("Array"===s)i=[];else{if("Object"!==s)return e;i={}}for(const s in e){const n=e[s];i[s]=t(n)}return i}function e(t,i){for(const s in i)t[s]&&"object"==typeof t[s]?e(t[s],i[s]):t[s]=i[s]}function i(i,...s){for(let n=0;n<s.length;n++)e(i,t(s[n]));return i}const s=function(){};let n;const o=function(t){return setTimeout(()=>{let e=(new Date).getTime();n||(n=e),t(e-n)},100/6)},r=function(t){return clearTimeout(t)};function a(t){return 1- --t*t*t*t}class h{constructor(t){this._offset=i({},t.offset),this._beginProgress=t.beginProgress||0,this.beginProgress=this._beginProgress,this.duration=t.duration,this.between=t.between,this.easing=t.easing,this.stepCallback=t.stepCallback,this.doneCallback=t.doneCallback,this.isAuto=t.isAuto,this.isLoop=t.isLoop,this.isAuto&&this.start()}clearOffset(){this.offset={};for(const t in this._offset){const e=this._offset[t].begin||0,i=this._offset[t].end;this.offset[t]={begin:e,end:i}}}start(){this.clearOffset(),this.requestAnimationFrameId=o(t=>{this.timeStart=t,t+=this.beginProgress*this.duration,this.isRunning=!0,this.loop(t)})}loop(t){this.isRunning&&(this.update(t),this.timeCurrent<this.duration?this.continueHandler():this.doneHandler())}continueHandler(){this.setTransform(),this.requestAnimationFrameId=o(t=>{t+=this.beginProgress*this.duration,this.loop(t)})}doneHandler(){this.timeCurrent=this.duration,this.setTransform(),"function"==typeof this.doneCallback&&this.doneCallback(),this.isLoop&&(clearTimeout(this.betweenTimeout),this.betweenTimeout=setTimeout(()=>{this.loopStart()},this.between))}update(t){this.timeCurrent=t-this.timeStart}setTransform(){let t="";for(let e in this.offset){const i=this.offset[e].begin,s=this.offset[e].end;this.timeCurrent<this.duration?t+=`${e}(${(s-i)*(this.timeCurrent/this.duration)+i}px) `:t+=`${e}(${s}px) `}const e=this.duration?this.timeCurrent/this.duration:1;this.stepCallback({transform:t,progress:e})}stop(){this.isRunning=!1,r(this.requestAnimationFrameId)}loopStart(){this.beginProgress=0,this.start()}restart(){this.beginProgress=this._beginProgress,this.start()}destroy(){this.isRunning=!1,r(this.requestAnimationFrameId)}}return t=>new h(i({},{offset:{},duration:1e3,between:0,easing:a,doneCallback:s,stepCallback:s,isAuto:!0,isLoop:!1},t))},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).WxMiniappAnimation=e();